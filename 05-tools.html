<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å·¥å…·ç³»ç»Ÿ - LangChain 1.0 çŸ¥è¯†ç‚¹</title>
    <link rel="stylesheet" href="assets/css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">
</head>
<body class="chapter-tools">
    <button class="theme-toggle">ğŸŒ“</button>
    <button class="mobile-menu-btn" onclick="toggleSidebar()">â˜°</button>

    <div class="app-container">
        <nav class="sidebar">
            <div class="sidebar-header">
                <h1>LangChain 1.0</h1>
                <p style="color: rgba(255,255,255,0.6); font-size: 0.9rem; margin-top: 5px;">çŸ¥è¯†ç‚¹</p>
            </div>
            <div class="sidebar-nav"></div>
        </nav>

        <main class="main-content">
            <div class="content">
                <h1>å·¥å…·ç³»ç»Ÿ (Tools)</h1>
                <p class="subtitle">æ‰©å±• LLM èƒ½åŠ›çš„å¤–éƒ¨åŠŸèƒ½é›†æˆ</p>

                <h2>åŸºç¡€å·¥å…·å®šä¹‰</h2>

                <h3>@tool è£…é¥°å™¨</h3>
                <div class="code-block">
                    <div class="code-header">
                        <span class="code-language">python</span>
                        <button class="copy-btn">å¤åˆ¶</button>
                    </div>
                    <pre><code class="language-python">from langchain_core.tools import tool

# ç®€å•å·¥å…·
@tool
def greet(name: str) -> str:
    """å‘æŒ‡å®šçš„äººé—®å¥½"""
    return f"ä½ å¥½ï¼Œ{name}ï¼"

# ä½¿ç”¨
result = greet.invoke("å°æ˜")
print(result)  # "ä½ å¥½ï¼Œå°æ˜ï¼"

# æŸ¥çœ‹å·¥å…·çš„ JSON Schema
print(greet.name)  # 'greet'
print(greet.description)  # 'å‘æŒ‡å®šçš„äººé—®å¥½'
print(greet.args)</code></pre>
                </div>

                <h3>å¸¦ schema çš„å·¥å…·</h3>
                <div class="code-block">
                    <div class="code-header">
                        <span class="code-language">python</span>
                        <button class="copy-btn">å¤åˆ¶</button>
                    </div>
                    <pre><code class="language-python">from pydantic import BaseModel, Field
from langchain_core.tools import tool

class SearchInput(BaseModel):
    """æœç´¢è¾“å…¥"""
    query: str = Field(..., description="æœç´¢å…³é”®è¯")
    limit: int = Field(default=5, description="ç»“æœæ•°é‡é™åˆ¶")

@tool(args_schema=SearchInput)
def search(input: SearchInput) -> str:
    """æœç´¢ä¿¡æ¯"""
    return f"æœç´¢ '{input.query}'ï¼Œè¿”å› {input.limit} æ¡ç»“æœ"</code></pre>
                </div>

                <h2>bind_tools() æ–¹æ³•ï¼ˆv1.0 æ–°ç‰¹æ€§ï¼‰</h2>

                <p><code>bind_tools()</code> å…è®¸ç›´æ¥å°†å·¥å…·ç»‘å®šåˆ° LLMï¼Œæ— éœ€åˆ›å»ºå®Œæ•´çš„ Agentï¼š</p>

                <div class="code-block">
                    <div class="code-header">
                        <span class="code-language">python</span>
                        <button class="copy-btn">å¤åˆ¶</button>
                    </div>
                    <pre><code class="language-python">from langchain_openai import ChatOpenAI
from langchain_core.tools import tool

@tool
def get_weather(location: str) -> str:
    """è·å–æŒ‡å®šåŸå¸‚çš„å¤©æ°”ä¿¡æ¯"""
    # æ¨¡æ‹Ÿå¤©æ°”æŸ¥è¯¢
    return f"{location} ä»Šå¤© 25Â°Cï¼Œæ™´å¤©"

@tool
def get_time(city: str) -> str:
    """è·å–æŒ‡å®šåŸå¸‚çš„å½“å‰æ—¶é—´"""
    from datetime import datetime
    return f"{city} å½“å‰æ—¶é—´: {datetime.now().strftime('%H:%M')}"

# åˆ›å»º LLM
llm = ChatOpenAI(model="gpt-4o")

# ç›´æ¥ç»‘å®šå·¥å…·
llm_with_tools = llm.bind_tools(
    [get_weather, get_time],
    tool_choice="auto"  # è‡ªåŠ¨é€‰æ‹©å·¥å…·
)

# è°ƒç”¨ï¼šLLM ä¼šè‡ªåŠ¨å†³å®šæ˜¯å¦ä½¿ç”¨å·¥å…·
response = llm_with_tools.invoke("åŒ—äº¬ä»Šå¤©å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿ")

# æŸ¥çœ‹å·¥å…·è°ƒç”¨
if response.tool_calls:
    for call in response.tool_calls:
        print(f"è°ƒç”¨å·¥å…·: {call['name']}")
        print(f"å‚æ•°: {call['args']}")
        # æ‰§è¡Œå·¥å…·
        if call['name'] == 'get_weather':
            result = get_weather(**call['args'])
            print(f"ç»“æœ: {result}")</code></pre>
                </div>

                <pre class="mermaid">sequenceDiagram
    participant U as ç”¨æˆ·
    participant L as LLM + bind_tools
    participant T as å·¥å…·

    U->>L: "åŒ—äº¬å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿ"
    L->>L: åˆ†æéœ€è¦å·¥å…·
    L->>T: è°ƒç”¨ get_weather
    T-->>L: è¿”å›ç»“æœ
    L-->>U: "åŒ—äº¬ä»Šå¤© 25Â°C"</code></pre>

                <div class="tip" data-label="v1.0 æ–°ç‰¹æ€§">
                    <code>bind_tools()</code> æ˜¯ LangChain 1.0 çš„æ–° APIï¼Œæ¯”ä¼ ç»Ÿçš„ <code>create_agent</code> æ›´ç®€æ´ï¼Œé€‚åˆç®€å•çš„å·¥å…·è°ƒç”¨åœºæ™¯ã€‚
                </div>

                <h2>å¸¸ç”¨å†…ç½®å·¥å…·</h2>

                <h3>ç½‘ç»œæœç´¢å·¥å…·</h3>
                <div class="code-block">
                    <div class="code-header">
                        <span class="code-language">python</span>
                        <button class="copy-btn">å¤åˆ¶</button>
                    </div>
                    <pre><code class="language-python">from langchain_community.tools import GoogleSearchRun
from langchain_community.utilities import GoogleSearchAPIWrapper

# åˆ›å»ºæœç´¢å·¥å…·
search = GoogleSearchRun(
    api_wrapper=GoogleSearchAPIWrapper(
        google_api_key="YOUR_API_KEY",
        google_cse_id="YOUR_CSE_ID"
    )
)

# æ‰§è¡Œæœç´¢
results = search.run("LangChain 1.0 æ–°ç‰¹æ€§")
print(results)

# æˆ–è€…ä½¿ç”¨ SerpAPI
from langchain_community.utilities import SerpAPIWrapper

search = SerpAPIWrapper(serpapi_key="YOUR_KEY")
results = search.run("Python æœ€æ–°ç‰ˆæœ¬")</code></pre>
                </div>

                <h3>æ•°æ®åº“å·¥å…·ï¼ˆSQLDatabaseToolkitï¼‰</h3>
                <div class="code-block">
                    <div class="code-header">
                        <span class="code-language">python</span>
                        <button class="copy-btn">å¤åˆ¶</button>
                    </div>
                    <pre><code class="language-python">from langchain_community.utilities import SQLDatabase
from langchain_community.toolkits import SQLDatabaseToolkit
from langchain_openai import ChatOpenAI

# è¿æ¥æ•°æ®åº“
db = SQLDatabase.from_uri(
    "sqlite:///chinook.db"  # æˆ– PostgreSQL/MySQL è¿æ¥å­—ç¬¦ä¸²
)

# åˆ›å»ºå·¥å…·åŒ…
llm = ChatOpenAI(model="gpt-4o")
toolkit = SQLDatabaseToolkit(db=db, llm=llm)

# è·å–æ‰€æœ‰å¯ç”¨å·¥å…·
tools = toolkit.get_tools()

for tool in tools:
    print(f"{tool.name}: {tool.description}")

# å¸¸ç”¨å·¥å…·ï¼š
# - sql_db_query: æ‰§è¡Œ SQL æŸ¥è¯¢
# - sql_db_schema: è·å–æ•°æ®åº“è¡¨ç»“æ„
# - sql_db_list_tables: åˆ—å‡ºæ‰€æœ‰è¡¨
# - sql_db_tables_schema: è·å–å¤šä¸ªè¡¨çš„ç»“æ„

# æ‰§è¡ŒæŸ¥è¯¢
query_tool = toolkit.get_tools()[0]
result = query_tool.run("SELECT * FROM users LIMIT 5")
print(result)</code></pre>
                </div>

                <h3>HTTP è¯·æ±‚å·¥å…·</h3>
                <div class="code-block">
                    <div class="code-header">
                        <span class="code-language">python</span>
                        <button class="copy-btn">å¤åˆ¶</button>
                    </div>
                    <pre><code class="language-python">from langchain_community.tools import (
    RequestsGetTool,
    RequestsPostTool
)

# GET è¯·æ±‚
get_tool = RequestsGetTool()
response = get_tool.run("https://api.github.com/repos/langchain-ai/langchain")
print(response)

# POST è¯·æ±‚
post_tool = RequestsPostTool()
response = post_tool.run({
    "url": "https://api.example.com/data",
    "data": {"key": "value"},
    "headers": {"Content-Type": "application/json"}
})
print(response)</code></pre>
                </div>

                <h3>Shell å·¥å…·</h3>
                <div class="code-block">
                    <div class="code-header">
                        <span class="code-language">python</span>
                        <button class="copy-btn">å¤åˆ¶</button>
                    </div>
                    <pre><code class="language-python">from langchain_community.tools import ShellTool

shell_tool = ShellTool()

# æ‰§è¡Œ Shell å‘½ä»¤
result = shell_tool.run("ls -la")
print(result)

# å¤šä¸ªå‘½ä»¤
result = shell_tool.run("cd /tmp && pwd && ls")</code></pre>
                </div>

                <div class="warning" data-label="å®‰å…¨è­¦å‘Š">
                    Shell å·¥å…·å¯ä»¥æ‰§è¡Œä»»æ„å‘½ä»¤ï¼Œç”Ÿäº§ç¯å¢ƒä½¿ç”¨æ—¶éœ€è¦è°¨æ…ï¼å»ºè®®é™åˆ¶å¯ç”¨å‘½ä»¤æˆ–ä½¿ç”¨æ²™ç®±ç¯å¢ƒã€‚
                </div>

                <h2>å·¥å…·é“¾ç»„åˆ</h2>

                <p>ä½¿ç”¨ LCEL å°†å¤šä¸ªå·¥å…·ç»„åˆæˆé“¾ï¼š</p>

                <div class="code-block">
                    <div class="code-header">
                        <span class="code-language">python</span>
                        <button class="copy-btn">å¤åˆ¶</button>
                    </div>
                    <pre><code class="language-python">from langchain_core.tools import tool
from langchain_core.runnables import RunnableLambda

@tool
def validate_input(input_data: dict) -> dict:
    """éªŒè¯è¾“å…¥"""
    if not input_data.get("query"):
        raise ValueError("æŸ¥è¯¢ä¸èƒ½ä¸ºç©º")
    if len(input_data["query"]) > 100:
        input_data["query"] = input_data["query"][:100]
    return input_data

@tool
def search_tool(input_data: dict) -> str:
    """æ‰§è¡Œæœç´¢"""
    return f"æœç´¢ '{input_data['query']}' çš„ç»“æœ..."

@tool
def format_result(result: str) -> str:
    """æ ¼å¼åŒ–ç»“æœ"""
    return f"=== æœç´¢ç»“æœ ===\n{result}\n=== ç»“æŸ ==="

# åˆ›å»ºå·¥å…·é“¾
tool_chain = (
    validate_input
    | search_tool
    | format_result
)

# æ‰§è¡Œé“¾
result = tool_chain.invoke({"query": "LangChain æ•™ç¨‹"})
print(result)</code></pre>
                </div>

                <pre class="mermaid">graph TD
    A[è¾“å…¥] --> B{éªŒè¯}
    B -->|å¤±è´¥| C[è¿”å›é”™è¯¯]
    B -->|æˆåŠŸ| D[æœç´¢å·¥å…·]
    D --> E[æ ¼å¼åŒ–]
    E --> F[è¿”å›ç»“æœ]</code></pre>

                <h2>å·¥å…·é”™è¯¯å¤„ç†</h2>

                <div class="code-block">
                    <div class="code-header">
                        <span class="code-language">python</span>
                        <button class="copy-btn">å¤åˆ¶</button>
                    </div>
                    <pre><code class="language-python">from langchain_core.tools import tool
from typing import Optional

@tool
def safe_divide(a: float, b: float) -> Optional[float]:
    """å®‰å…¨çš„é™¤æ³•è¿ç®—ï¼Œå¤„ç†é™¤é›¶é”™è¯¯"""
    try:
        return a / b
    except ZeroDivisionError:
        return None
    except Exception as e:
        return f"é”™è¯¯: {str(e)}"

# åœ¨ Agent ä¸­ä½¿ç”¨å·¥å…·æ—¶çš„é”™è¯¯å¤„ç†
from langchain_core.runnables import RunnableLambda

def handle_tool_error(output):
    """å¤„ç†å·¥å…·æ‰§è¡Œé”™è¯¯"""
    if isinstance(output, Exception):
        return f"å·¥å…·æ‰§è¡Œå¤±è´¥: {str(output)}"
    return output

# å¸¦é”™è¯¯å¤„ç†çš„å·¥å…·é“¾
safe_chain = (
    safe_divide
    | RunnableLambda(handle_tool_error)
)

result = safe_chain.invoke({"a": 10, "b": 0})
print(result)  # "å·¥å…·æ‰§è¡Œå¤±è´¥: division by zero"</code></pre>
                </div>

                <h2>ç»“æ„åŒ–å·¥å…·</h2>

                <h3>StructuredTool</h3>
                <div class="code-block">
                    <div class="code-header">
                        <span class="code-language">python</span>
                        <button class="copy-btn">å¤åˆ¶</button>
                    </div>
                    <pre><code class="language-python">from langchain_core.tools import StructuredTool
from pydantic import BaseModel, Field

class WeatherInput(BaseModel):
    location: str = Field(..., description="åŸå¸‚åç§°")

class WeatherOutput(BaseModel):
    temperature: float
    condition: str
    humidity: int

def get_weather_func(location: str) -> WeatherOutput:
    """è·å–å¤©æ°”ä¿¡æ¯"""
    import random
    return WeatherOutput(
        temperature=random.uniform(15, 35),
        condition=random.choice(["æ™´", "å¤šäº‘", "é›¨"]),
        humidity=random.randint(30, 80)
    )

# åˆ›å»ºç»“æ„åŒ–å·¥å…·
weather_tool = StructuredTool.from_function(
    func=get_weather_func,
    name="get_weather",
    description="è·å–æŒ‡å®šåŸå¸‚çš„å¤©æ°”ä¿¡æ¯",
    args_schema=WeatherInput
)

# ä½¿ç”¨
result = weather_tool.invoke({"location": "åŒ—äº¬"})
print(f"æ¸©åº¦: {result.temperature}Â°C")
print(f"å¤©æ°”: {result.condition}")
print(f"æ¹¿åº¦: {result.humidity}%")</code></pre>
                </div>

                <h2>å¼‚æ­¥å·¥å…·</h2>

                <div class="code-block">
                    <div class="code-header">
                        <span class="code-language">python</span>
                        <button class="copy-btn">å¤åˆ¶</button>
                    </div>
                    <pre><code class="language-python">import asyncio
from langchain_core.tools import tool

# å¼‚æ­¥å·¥å…·
@tool
async def async_fetch(url: str) -> str:
    """å¼‚æ­¥è·å– URL å†…å®¹"""
    import aiohttp
    async with aiohttp.ClientSession() as session:
        async with session.get(url) as response:
            return await response.text()

# æ‰¹é‡å¼‚æ­¥è°ƒç”¨
async def fetch_multiple():
    urls = [
        "https://api.github.com/users/langchain-ai",
        "https://api.github.com/users/openai"
    ]
    tasks = [async_fetch.invoke({"url": url}) for url in urls]
    results = await asyncio.gather(*tasks)
    return results

# è¿è¡Œ
results = asyncio.run(fetch_multiple())
for result in results:
    print(result)</code></pre>
                </div>

                <h2>å·¥å…·è°ƒä¼˜æŠ€å·§</h2>

                <div class="code-block">
                    <div class="code-header">
                        <span class="code-language">python</span>
                        <button class="copy-btn">å¤åˆ¶</button>
                    </div>
                    <pre><code class="language-python">from langchain_core.tools import tool

# 1. ä¼˜åŒ–å·¥å…·æè¿°
@tool
def search_docs(query: str, category: str = "all") -> str:
    """
    åœ¨æ–‡æ¡£åº“ä¸­æœç´¢ç›¸å…³ä¿¡æ¯ã€‚

    ä½¿ç”¨åœºæ™¯ï¼šç”¨æˆ·è¯¢é—®æŠ€æœ¯é—®é¢˜æ—¶ä½¿ç”¨æ­¤å·¥å…·ã€‚
    å‚æ•°è¯´æ˜ï¼š
    - query: æœç´¢å…³é”®è¯
    - category: æ–‡æ¡£ç±»åˆ«ï¼ˆå¯é€‰ï¼‰ï¼Œé»˜è®¤æœç´¢æ‰€æœ‰ç±»åˆ«
    """
    # æœç´¢é€»è¾‘
    return f"åœ¨ {category} ç±»åˆ«ä¸­æœç´¢ '{query}' çš„ç»“æœ"

# 2. æ·»åŠ è¿”å›ç±»å‹æç¤º
@tool
def get_user_info(user_id: int) -> dict:
    """è·å–ç”¨æˆ·ä¿¡æ¯ï¼Œè¿”å›åŒ…å«ç”¨æˆ·è¯¦ç»†ä¿¡æ¯çš„å­—å…¸"""
    return {
        "id": user_id,
        "name": "ç”¨æˆ·å",
        "email": "user@example.com"
    }

# 3. ä½¿ç”¨ç¼“å­˜åŠ é€Ÿ
from functools import lru_cache

@tool
@lru_cache(maxsize=100)
def cached_lookup(code: str) -> str:
    """å¸¦ç¼“å­˜çš„æŸ¥è¯¢å·¥å…·"""
    # è€—æ—¶æŸ¥è¯¢
    return f"æŸ¥è¯¢ {code} çš„ç»“æœ"</code></pre>
                </div>

                <div class="tip" data-label="æœ€ä½³å®è·µ">
                    â€¢ å·¥å…·æè¿°è¦æ¸…æ™°è¯´æ˜ç”¨é€”å’Œä½¿ç”¨åœºæ™¯<br>
                    â€¢ å‚æ•°æè¿°è¦è¯¦ç»†ï¼Œå¸®åŠ© LLM æ­£ç¡®è°ƒç”¨<br>
                    â€¢ å¯¹äºè€—æ—¶æ“ä½œï¼Œæ·»åŠ ç¼“å­˜æé«˜æ€§èƒ½<br>
                    â€¢ åˆç†ä½¿ç”¨å¼‚å¸¸å¤„ç†ï¼Œé¿å…å·¥å…·å´©æºƒ
                </div>

                <nav class="chapter-nav">
                    <a href="05-agents.html" class="prev">â† æ™ºèƒ½ä½“</a>
                    <a href="07-memory.html" class="next">è®°å¿†ç®¡ç† â†’</a>
                </nav>

                <div class="exercise-section">
                    <h3>âœï¸ ç»ƒä¹ é¢˜</h3>

                    <div class="question">
                        <div class="question-title">
                            <span class="question-type">é€‰æ‹©é¢˜</span>
                            1. bind_tools() æ–¹æ³•çš„ä¸»è¦ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ
                        </div>
                        <div class="options">
                            <div class="option" onclick="this.classList.toggle('selected')">A. åˆ›å»ºæ–°å·¥å…·</div>
                            <div class="option correct-option onclick="this.classList.toggle('selected')">B. å°†å·¥å…·ç›´æ¥ç»‘å®šåˆ° LLM</div>
                            <div class="option" onclick="this.classList.toggle('selected')">C. éªŒè¯å·¥å…·å‚æ•°</div>
                            <div class="option" onclick="this.classList.toggle('selected')">D. ç¼“å­˜å·¥å…·ç»“æœ</div>
                        </div>
                    </div>

                    <div class="question">
                        <div class="question-title">
                            <span class="question-type">é€‰æ‹©é¢˜</span>
                            2. SQLDatabaseToolkit çš„ä¸»è¦åŠŸèƒ½æ˜¯ä»€ä¹ˆï¼Ÿ
                        </div>
                        <div class="options">
                            <div class="option" onclick="this.classList.toggle('selected')">A. åˆ›å»ºæ•°æ®åº“</div>
                            <div class="option" onclick="this.classList.toggle('selected')">B. å¤‡ä»½æ•°æ®åº“</div>
                            <div class="option correct-option onclick="this.classList.toggle('selected')">C. è®© LLM èƒ½ä¸ SQL æ•°æ®åº“äº¤äº’</div>
                            <div class="option" onclick="this.classList.toggle('selected')">D. åŠ å¯†æ•°æ®åº“</div>
                        </div>
                    </div>

                    <div class="question">
                        <div class="question-title">
                            <span class="question-type">é€‰æ‹©é¢˜</span>
                            3. å·¥å…·é“¾ä¸­çš„é”™è¯¯åº”è¯¥åœ¨å“ªé‡Œå¤„ç†ï¼Ÿ
                        </div>
                        <div class="options">
                            <div class="option" onclick="this.classList.toggle('selected')">A. åªåœ¨å·¥å…·å†…éƒ¨å¤„ç†</div>
                            <div class="option" onclick="this.classList.toggle('selected')">B. åªåœ¨ Agent ä¸­å¤„ç†</div>
                            <div class="option correct-option onclick="this.classList.toggle('selected')">C. å·¥å…·å†…éƒ¨ + é“¾ä¸­çš„é”™è¯¯å¤„ç†å™¨</div>
                            <div class="option" onclick="this.classList.toggle('selected')">D. ä¸éœ€è¦å¤„ç†</div>
                        </div>
                    </div>

                    <div class="question">
                        <div class="question-title">
                            <span class="question-type">ä»£ç å¡«ç©º</span>
                            4. è¡¥å…¨ä»¥ä¸‹å·¥å…·é“¾çš„é…ç½®
                        </div>
                        <div class="code-block">
                            <div class="code-header">
                                <span class="code-language">python</span>
                            </div>
                            <pre><code class="language-python">from langchain_core.tools import tool

@tool
def validate(data: dict) -> dict:
    return data

@tool
def process(data: dict) -> str:
    return "å¤„ç†ç»“æœ"

# åˆ›å»ºå·¥å…·é“¾
tool_chain = validate | ______
result = tool_chain.invoke({"key": "value"})</code></pre>
                        </div>
                        <details style="margin-top: 10px;">
                            <summary style="cursor: pointer; color: var(--primary-color);">æŸ¥çœ‹ç­”æ¡ˆ</summary>
                            <div style="margin-top: 10px; padding: 10px; background: rgba(16, 185, 129, 0.1); border-radius: 5px;">
                                <code>process</code>
                            </div>
                        </details>
                    </div>

                    <div class="question">
                        <div class="question-title">
                            <span class="question-type">ç¼–ç¨‹é¢˜</span>
                            5. åˆ›å»ºä¸€ä¸ªå·¥å…·é“¾ï¼ŒåŒ…å«ï¼šè¾“å…¥éªŒè¯ â†’ æ•°æ®æŸ¥è¯¢ â†’ ç»“æœæ ¼å¼åŒ–
                        </div>
                        <details style="margin-top: 10px;">
                            <summary style="cursor: pointer; color: var(--primary-color);">æŸ¥çœ‹å‚è€ƒç­”æ¡ˆ</summary>
                            <div class="code-block" style="margin-top: 10px;">
                                <div class="code-header">
                                    <span class="code-language">python</span>
                                    <button class="copy-btn">å¤åˆ¶</button>
                                </div>
                                <pre><code class="language-python">from langchain_core.tools import tool
from langchain_core.runnables import RunnableLambda

@tool
def validate_input(input_data: dict) -> dict:
    """éªŒè¯è¾“å…¥"""
    if not input_data.get("user_id"):
        raise ValueError("user_id æ˜¯å¿…éœ€çš„")
    return input_data

@tool
def query_database(input_data: dict) -> dict:
    """æŸ¥è¯¢æ•°æ®åº“"""
    user_id = input_data["user_id"]
    # æ¨¡æ‹Ÿæ•°æ®åº“æŸ¥è¯¢
    return {
        "user_id": user_id,
        "name": "å¼ ä¸‰",
        "email": "zhangsan@example.com",
        "balance": 1000.50
    }

@tool
def format_output(data: dict) -> str:
    """æ ¼å¼åŒ–è¾“å‡º"""
    return f"""
    ç”¨æˆ·ä¿¡æ¯ï¼š
    - ID: {data['user_id']}
    - å§“å: {data['name']}
    - é‚®ç®±: {data['email']}
    - ä½™é¢: Â¥{data['balance']:.2f}
    """

# åˆ›å»ºå·¥å…·é“¾
tool_chain = (
    validate_input
    | query_database
    | format_output
)

# ä½¿ç”¨
result = tool_chain.invoke({"user_id": 123})
print(result)</code></pre>
                            </div>
                        </details>
                    </div>

                    <div class="question">
                        <div class="question-title">
                            <span class="question-type">åœºæ™¯é¢˜</span>
                            6. ä½ éœ€è¦ä¸ºä¸€ä¸ªä¼ä¸šè®¾è®¡å·¥å…·ç³»ç»Ÿï¼Œå…è®¸ LLM å®‰å…¨åœ°æ‰§è¡Œæ–‡ä»¶æ“ä½œå’Œ Shell å‘½ä»¤ï¼Œå¦‚ä½•è®¾è®¡ï¼Ÿ
                        </div>
                        <details style="margin-top: 10px;">
                            <summary style="cursor: pointer; color: var(--primary-color);">æŸ¥çœ‹å‚è€ƒæ–¹æ¡ˆ</summary>
                            <div style="margin-top: 15px; padding: 15px; background: rgba(59, 130, 246, 0.1); border-radius: 10px;">
                                <strong>æ–¹æ¡ˆè¦ç‚¹ï¼š</strong>
                                <ul>
                                    <li><strong>è¾“å…¥éªŒè¯</strong>ï¼šä¸¥æ ¼éªŒè¯æ–‡ä»¶è·¯å¾„ï¼Œé˜²æ­¢è·¯å¾„éå†æ”»å‡»</li>
                                    <li><strong>ç™½åå•æœºåˆ¶</strong>ï¼šåªå…è®¸æ‰§è¡Œé¢„å®šä¹‰çš„å®‰å…¨å‘½ä»¤</li>
                                    <li><strong>æ²™ç®±ç¯å¢ƒ</strong>ï¼šä½¿ç”¨ Docker æˆ– chroot éš”ç¦»æ‰§è¡Œç¯å¢ƒ</li>
                                    <li><strong>æƒé™é™åˆ¶</strong>ï¼šä½¿ç”¨æœ€å°æƒé™åŸåˆ™è¿è¡Œå·¥å…·</li>
                                    <li><strong>å®¡è®¡æ—¥å¿—</strong>ï¼šè®°å½•æ‰€æœ‰å·¥å…·è°ƒç”¨ï¼Œä¾¿äºå®¡æŸ¥</li>
                                    <li><strong>è¶…æ—¶æ§åˆ¶</strong>ï¼šè®¾ç½®å·¥å…·æ‰§è¡Œè¶…æ—¶ï¼Œé˜²æ­¢èµ„æºè€—å°½</li>
                                </ul>
                            </div>
                        </details>
                    </div>

                    <div class="question">
                        <div class="question-title">
                            <span class="question-type">é€‰æ‹©é¢˜</span>
                            7. ShellTool æ‰§è¡Œå‘½ä»¤å¤±è´¥æ—¶ï¼Œåº”è¯¥å¦‚ä½•å¤„ç†ï¼Ÿ
                        </div>
                        <div class="options">
                            <div class="option" onclick="this.classList.toggle('selected')">A. å¿½ç•¥é”™è¯¯</div>
                            <div class="option" onclick="this.classList.toggle('selected')">B. é‡è¯•ç›´åˆ°æˆåŠŸ</div>
                            <div class="option correct-option onclick="this.classList.toggle('selected')">C. æ•è·å¼‚å¸¸å¹¶è¿”å›å‹å¥½çš„é”™è¯¯ä¿¡æ¯</div>
                            <div class="option" onclick="this.classList.toggle('selected')">D. ç»ˆæ­¢ç¨‹åº</div>
                        </div>
                    </div>

                    <div class="question">
                        <div class="question-title">
                            <span class="question-type">ç¼–ç¨‹é¢˜</span>
                            8. åˆ›å»ºä¸€ä¸ªé‚®ä»¶å‘é€å·¥å…·ï¼Œä½¿ç”¨ Pydantic è¿›è¡Œå‚æ•°éªŒè¯
                        </div>
                        <details style="margin-top: 10px;">
                            <summary style="cursor: pointer; color: var(--primary-color);">æŸ¥çœ‹å‚è€ƒç­”æ¡ˆ</summary>
                            <div class="code-block" style="margin-top: 10px;">
                                <div class="code-header">
                                    <span class="code-language">python</span>
                                    <button class="copy-btn">å¤åˆ¶</button>
                                </div>
                                <pre><code class="language-python">from langchain_core.tools import tool
from pydantic import BaseModel, Field, EmailStr
from typing import List

class EmailInput(BaseModel):
    """é‚®ä»¶è¾“å…¥å‚æ•°"""
    to: List[EmailStr] = Field(..., description="æ”¶ä»¶äººé‚®ç®±åˆ—è¡¨")
    subject: str = Field(..., min_length=1, max_length=200, description="é‚®ä»¶ä¸»é¢˜")
    body: str = Field(..., description="é‚®ä»¶æ­£æ–‡")
    cc: List[EmailStr] = Field(default=[], description="æŠ„é€åˆ—è¡¨")

@tool(args_schema=EmailInput)
def send_email(input: EmailInput) -> str:
    """
    å‘é€é‚®ä»¶ç»™æŒ‡å®šæ”¶ä»¶äººã€‚

    å‚æ•°ï¼š
    - to: æ”¶ä»¶äººé‚®ç®±ï¼ˆæ”¯æŒå¤šä¸ªï¼‰
    - subject: é‚®ä»¶ä¸»é¢˜
    - body: é‚®ä»¶æ­£æ–‡
    - cc: æŠ„é€åˆ—è¡¨ï¼ˆå¯é€‰ï¼‰
    """
    # å®é™…åº”ç”¨ä¸­è°ƒç”¨é‚®ä»¶æœåŠ¡ API
    recipients = ", ".join(input.to)
    cc_list = ", ".join(input.cc) if input.cc else "æ— "

    return f"""
    é‚®ä»¶å·²å‘é€ï¼
    æ”¶ä»¶äºº: {recipients}
    æŠ„é€: {cc_list}
    ä¸»é¢˜: {input.subject}
    æ­£æ–‡é•¿åº¦: {len(input.body)} å­—ç¬¦
    """

# ä½¿ç”¨
result = send_email.invoke({
    "to": ["user1@example.com", "user2@example.com"],
    "subject": "é‡è¦é€šçŸ¥",
    "body": "è¿™æ˜¯ä¸€å°æµ‹è¯•é‚®ä»¶ã€‚",
    "cc": ["manager@example.com"]
})
print(result)</code></pre>
                            </div>
                        </details>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script src="assets/js/main.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
</body>
</html>
