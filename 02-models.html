<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¨¡å‹æ¨¡å— - LangChain 1.0 çŸ¥è¯†ç‚¹</title>
    <link rel="stylesheet" href="assets/css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">
</head>
<body class="chapter-models">
    <button class="theme-toggle">ğŸŒ“</button>
    <button class="mobile-menu-btn" onclick="toggleSidebar()">â˜°</button>

    <div class="app-container">
        <nav class="sidebar">
            <div class="sidebar-header">
                <h1>LangChain 1.0</h1>
                <p style="color: rgba(255,255,255,0.6); font-size: 0.9rem; margin-top: 5px;">çŸ¥è¯†ç‚¹</p>
            </div>
            <div class="sidebar-nav"></div>
        </nav>

        <main class="main-content">
            <div class="content">
                <h1>æ¨¡å‹æ¨¡å— (Models)</h1>
                <p class="subtitle">ç»Ÿä¸€æ¥å£è°ƒç”¨å¤šç§å¤§è¯­è¨€æ¨¡å‹</p>

                <h2>æ¨¡å‹ç±»å‹</h2>
                <p>LangChain æä¾›ä¸¤ç§ä¸»è¦çš„æ¨¡å‹æ¥å£ï¼š</p>

                <table class="comparison-table">
                    <tr>
                        <th>ç±»å‹</th>
                        <th>ç”¨é€”</th>
                        <th>è¾“å…¥</th>
                        <th>è¾“å‡º</th>
                    </tr>
                    <tr>
                        <td><code>LLM</code></td>
                        <td>æ–‡æœ¬è¡¥å…¨</td>
                        <td>å­—ç¬¦ä¸²</td>
                        <td>å­—ç¬¦ä¸²</td>
                    </tr>
                    <tr>
                        <td><code>ChatModel</code></td>
                        <td>å¯¹è¯äº¤äº’</td>
                        <td>æ¶ˆæ¯åˆ—è¡¨</td>
                        <td>æ¶ˆæ¯</td>
                    </tr>
                </table>

                <h2>åŸºç¡€ç”¨æ³•</h2>

                <h3>1. OpenAI æ¨¡å‹</h3>
                <div class="code-block">
                    <div class="code-header">
                        <span class="code-language">python</span>
                        <button class="copy-btn">å¤åˆ¶</button>
                    </div>
                    <pre><code class="language-python">from langchain_openai import ChatOpenAI
from langchain_openai import OpenAI

# ChatModel - æ¨è
chat = ChatOpenAI(
    model="gpt-4o",
    temperature=0.7,
    max_tokens=1000
)

# LLM - ä¼ ç»Ÿæ–‡æœ¬è¡¥å…¨
llm = OpenAI(
    model="gpt-3.5-turbo-instruct",
    temperature=0.5
)

# è°ƒç”¨ ChatModel
response = chat.invoke([
    {"role": "user", "content": "ä½ å¥½ï¼Œè¯·ä»‹ç»ä¸€ä¸‹ä½ è‡ªå·±"}
])
print(response.content)

# è°ƒç”¨ LLM
completion = llm.invoke("Once upon a time")
print(completion)</code></pre>
                </div>

                <h3>2. Anthropic Claude</h3>
                <div class="code-block">
                    <div class="code-header">
                        <span class="code-language">python</span>
                        <button class="copy-btn">å¤åˆ¶</button>
                    </div>
                    <pre><code class="language-python">from langchain_anthropic import ChatAnthropic

chat = ChatAnthropic(
    model="claude-sonnet-4-5-20250514",
    temperature=0.7,
    max_tokens=2000,
    anthropic_api_key="your-api-key"
)

response = chat.invoke([
    {"role": "user", "content": "è§£é‡Šä»€ä¹ˆæ˜¯æœºå™¨å­¦ä¹ "}
])
print(response.content)</code></pre>
                </div>

                <h3>3. Google Gemini</h3>
                <div class="code-block">
                    <div class="code-header">
                        <span class="code-language">python</span>
                        <button class="copy-btn">å¤åˆ¶</button>
                    </div>
                    <pre><code class="language-python">from langchain_google_genai import ChatGoogleGenerativeAI

chat = ChatGoogleGenerativeAI(
    model="gemini-2.0-flash-exp",
    temperature=0.7,
    google_api_key="your-api-key"
)

response = chat.invoke([
    {"role": "user", "content": "ç”¨ Python å†™ä¸€ä¸ªå¿«é€Ÿæ’åº"}
])
print(response.content)</code></pre>
                </div>

                <h2>æµå¼è¾“å‡º</h2>
                <p>æµå¼è¾“å‡ºå¯ä»¥é€å—è·å–å“åº”ï¼Œæå‡ç”¨æˆ·ä½“éªŒï¼š</p>

                <div class="code-block">
                    <div class="code-header">
                        <span class="code-language">python</span>
                        <button class="copy-btn">å¤åˆ¶</button>
                    </div>
                    <pre><code class="language-python">from langchain_openai import ChatOpenAI

chat = ChatOpenAI(model="gpt-4o")

# æ–¹æ³•ä¸€ï¼šä½¿ç”¨ stream()
print("æµå¼è¾“å‡º:")
for chunk in chat.stream("è®²ä¸€ä¸ªç®€çŸ­çš„æ•…äº‹"):
    print(chunk.content, end="", flush=True)

# æ–¹æ³•äºŒï¼šä½¿ç”¨ astream() - å¼‚æ­¥
import asyncio

async def async_stream():
    print("\nå¼‚æ­¥æµå¼è¾“å‡º:")
    async for chunk in chat.astream("ç”¨ä¸€å¥è¯æè¿° Python"):
        print(chunk.content, end="", flush=True)

asyncio.run(async_stream())</code></pre>
                </div>

                <h2>ç»“æ„åŒ–è¾“å‡º</h2>
                <p>ä½¿ç”¨ <code>with_structured_output</code> è·å–æ ¼å¼åŒ–çš„ JSON è¾“å‡ºï¼š</p>

                <div class="code-block">
                    <div class="code-header">
                        <span class="code-language">python</span>
                        <button class="copy-btn">å¤åˆ¶</button>
                    </div>
                    <pre><code class="language-python">from langchain_openai import ChatOpenAI
from pydantic import BaseModel, Field

# å®šä¹‰è¾“å‡ºç»“æ„
class WeatherInfo(BaseModel):
    """å¤©æ°”ä¿¡æ¯"""
    location: str = Field(..., description="ä½ç½®")
    temperature: float = Field(..., description="æ¸©åº¦ï¼ˆæ‘„æ°åº¦ï¼‰")
    condition: str = Field(..., description="å¤©æ°”çŠ¶å†µ")
    humidity: int = Field(..., description="æ¹¿åº¦ç™¾åˆ†æ¯”")

# åˆ›å»ºç»“æ„åŒ–è¾“å‡ºæ¨¡å‹
chat = ChatOpenAI(model="gpt-4o")
structured_chat = chat.with_structured_output(WeatherInfo)

# è°ƒç”¨
result = structured_chat.invoke("åŒ—äº¬ä»Šå¤©çš„å¤©æ°”ï¼šæ¸©åº¦25åº¦ï¼Œæ™´å¤©ï¼Œæ¹¿åº¦60%")
print(f"ä½ç½®: {result.location}")
print(f"æ¸©åº¦: {result.temperature}Â°C")
print(f"å¤©æ°”: {result.condition}")
print(f"æ¹¿åº¦: {result.humidity}%")</code></pre>
                </div>

                <h2>å¤šæ¨¡æ€è¾“å…¥</h2>
                <p>æ”¯æŒæ–‡æœ¬ã€å›¾ç‰‡ç­‰å¤šç§è¾“å…¥ç±»å‹ï¼š</p>

                <div class="code-block">
                    <div class="code-header">
                        <span class="code-language">python</span>
                        <button class="copy-btn">å¤åˆ¶</button>
                    </div>
                    <pre><code class="language-python">from langchain_openai import ChatOpenAI
from langchain_core.messages import HumanMessage, AIMessage

chat = ChatOpenAI(model="gpt-4o")

# å›¾ç‰‡åˆ†æ
message = HumanMessage(
    content=[
        {"type": "text", "text": "è¿™å¼ å›¾ç‰‡é‡Œæœ‰ä»€ä¹ˆï¼Ÿ"},
        {
            "type": "image_url",
            "image_url": {
                "url": "https://example.com/image.jpg"
            }
        }
    ]
)

response = chat.invoke([message])
print(response.content)</code></pre>
                </div>

                <h2>æ¨¡å‹å‚æ•°è¯¦è§£</h2>

                <table class="comparison-table">
                    <tr>
                        <th>å‚æ•°</th>
                        <th>ç±»å‹</th>
                        <th>é»˜è®¤å€¼</th>
                        <th>è¯´æ˜</th>
                    </tr>
                    <tr>
                        <td><code>model</code></td>
                        <td>str</td>
                        <td>-</td>
                        <td>æ¨¡å‹åç§°ï¼ˆå¿…éœ€ï¼‰</td>
                    </tr>
                    <tr>
                        <td><code>temperature</code></td>
                        <td>float</td>
                        <td>0.7</td>
                        <td>éšæœºæ€§ï¼ˆ0-2ï¼‰ï¼Œè¶Šé«˜è¶Šéšæœº</td>
                    </tr>
                    <tr>
                        <td><code>max_tokens</code></td>
                        <td>int</td>
                        <td>-</td>
                        <td>æœ€å¤§è¾“å‡º tokens</td>
                    </tr>
                    <tr>
                        <td><code>top_p</code></td>
                        <td>float</td>
                        <td>1.0</td>
                        <td>æ ¸é‡‡æ ·ï¼ˆ0-1ï¼‰</td>
                    </tr>
                    <tr>
                        <td><code>frequency_penalty</code></td>
                        <td>float</td>
                        <td>0</td>
                        <td>é¢‘ç‡æƒ©ç½šï¼ˆ-2åˆ°2ï¼‰</td>
                    </tr>
                    <tr>
                        <td><code>presence_penalty</code></td>
                        <td>float</td>
                        <td>0</td>
                        <td>å­˜åœ¨æƒ©ç½šï¼ˆ-2åˆ°2ï¼‰</td>
                    </tr>
                    <tr>
                        <td><code>stop</code></td>
                        <td>list</td>
                        <td>null</td>
                        <td>åœæ­¢åºåˆ—</td>
                    </tr>
                </table>

                <h2>ç”Ÿäº§çº§é…ç½®</h2>

                <h3>é‡è¯•æœºåˆ¶</h3>
                <div class="code-block">
                    <div class="code-header">
                        <span class="code-language">python</span>
                        <button class="copy-btn">å¤åˆ¶</button>
                    </div>
                    <pre><code class="language-python">from langchain_openai import ChatOpenAI
from langchain_core.rate_limiters import InMemoryRateLimiter

chat = ChatOpenAI(
    model="gpt-4o",
    # é€Ÿç‡é™åˆ¶
    rate_limiter=InMemoryRateLimiter(
        requests_per_second=10,
        check_interval=0.1
    ),
    # è¶…æ—¶è®¾ç½®
    request_timeout=30,
    # æœ€å¤§é‡è¯•æ¬¡æ•°
    max_retries=3
)</code></pre>
                </div>

                <h3>æˆæœ¬è¿½è¸ª</h3>
                <div class="code-block">
                    <div class="code-header">
                        <span class="code-language">python</span>
                        <button class="copy-btn">å¤åˆ¶</button>
                    </div>
                    <pre><code class="language-python">from langchain_openai import ChatOpenAI
from langchain.callbacks import get_openai_callback

chat = ChatOpenAI(model="gpt-4o")

# è¿½è¸ªæˆæœ¬
with get_openai_callback() as cb:
    response = chat.invoke("å†™ä¸€é¦–å…³äºç¼–ç¨‹çš„è¯—")
    print(response.content)

    # æ‰“å°æˆæœ¬ä¿¡æ¯
    print(f"\næ€»æˆæœ¬: ${cb.total_cost:.4f}")
    print(f"è¾“å…¥ tokens: {cb.prompt_tokens}")
    print(f"è¾“å‡º tokens: {cb.completion_tokens}")
    print(f"æ€» tokens: {cb.total_tokens}")</code></pre>
                </div>

                <h2>æ¨¡å‹é€‰æ‹©æŒ‡å—</h2>

                <pre class="mermaid">graph TD
    A[æ¨¡å‹é€‰æ‹©] --> B{ä»»åŠ¡ç±»å‹}

    B -->|å¯¹è¯| C[ChatModel]
    B -->|æ–‡æœ¬è¡¥å…¨| D[LLM]

    C --> E{åœºæ™¯}
    C -->|ç®€å•ä»»åŠ¡| F[GPT-4o-mini]
    C -->|å¤æ‚æ¨ç†| G[GPT-4o / Claude 3.5 Sonnet]
    C -->|è¶…é•¿ä¸Šä¸‹æ–‡| H[Claude 3 Opus]

    D --> I{åœºæ™¯}
    D -->|ä»£ç è¡¥å…¨| J[GPT-4]
    D -->|æ–‡æœ¬ç”Ÿæˆ| K[GPT-3.5-turbo-instruct]</code></pre>

                <div class="tip" data-label="æç¤º">
                    <strong>æ¨¡å‹é€‰æ‹©å»ºè®®</strong>ï¼š<br>
                    â€¢ å¿«é€ŸåŸå‹/ç®€å•ä»»åŠ¡ï¼šGPT-4o-miniï¼ˆæˆæœ¬æœ€ä½ï¼‰<br>
                    â€¢ æ—¥å¸¸å¯¹è¯/ä¸­ç­‰å¤æ‚åº¦ï¼šGPT-4oã€Claude 3.5 Sonnet<br>
                    â€¢ å¤æ‚æ¨ç†/ä»£ç ç”Ÿæˆï¼šGPT-4oã€Claude 3 Opus<br>
                    â€¢ è¶…é•¿ä¸Šä¸‹æ–‡ï¼šClaude 3ï¼ˆ200K tokensï¼‰
                </div>

                <h2>å¸¸è§é—®é¢˜</h2>

                <h4>Q: ChatModel å’Œ LLM å¦‚ä½•é€‰æ‹©ï¼Ÿ</h4>
                <p>Aï¼šç»å¤§å¤šæ•°æƒ…å†µä½¿ç”¨ ChatModelã€‚LLM ä¸»è¦ç”¨äºç‰¹å®šçš„æ–‡æœ¬è¡¥å…¨åœºæ™¯ï¼ˆå¦‚ä»£ç è¡¥å…¨ï¼‰ã€‚</p>

                <h4>Q: å¦‚ä½•è®¾ç½® API Keyï¼Ÿ</h4>
                <p>Aï¼šæ¨èä½¿ç”¨ç¯å¢ƒå˜é‡ï¼Œä¹Ÿå¯ä»¥åœ¨åˆå§‹åŒ–æ—¶é€šè¿‡å‚æ•°ä¼ å…¥ï¼š</p>
                <div class="code-block">
                    <div class="code-header">
                        <span class="code-language">python</span>
                        <button class="copy-btn">å¤åˆ¶</button>
                    </div>
                    <pre><code class="language-python"># æ–¹å¼ä¸€ï¼šç¯å¢ƒå˜é‡ï¼ˆæ¨èï¼‰
import os
os.environ["OPENAI_API_KEY"] = "your-key"

# æ–¹å¼äºŒï¼šç›´æ¥ä¼ å…¥
chat = ChatOpenAI(
    model="gpt-4o",
    api_key="your-key"
)</code></pre>
                </div>

                <nav class="chapter-nav">
                    <a href="01-quickstart.html" class="prev">â† å¿«é€Ÿå…¥é—¨</a>
                    <a href="03-prompts.html" class="next">æç¤ºå·¥ç¨‹ â†’</a>
                </nav>

                <div class="exercise-section">
                    <h3>âœï¸ ç»ƒä¹ é¢˜</h3>

                    <div class="question">
                        <div class="question-title">
                            <span class="question-type">é€‰æ‹©é¢˜</span>
                            1. ä»¥ä¸‹å“ªä¸ªæ˜¯æµå¼è¾“å‡ºçš„æ­£ç¡®æ–¹æ³•ï¼Ÿ
                        </div>
                        <div class="options">
                            <div class="option" onclick="this.classList.toggle('selected')">A. chat.stream_fast()</div>
                            <div class="option correct-option onclick="this.classList.toggle('selected')">B. chat.stream()</div>
                            <div class="option" onclick="this.classList.toggle('selected')">C. chat.stream_all()</div>
                            <div class="option" onclick="this.classList.toggle('selected')">D. chat.output_stream()</div>
                        </div>
                    </div>

                    <div class="question">
                        <div class="question-title">
                            <span class="question-type">é€‰æ‹©é¢˜</span>
                            2. temperature å‚æ•°çš„ä½œç”¨æ˜¯ï¼Ÿ
                        </div>
                        <div class="options">
                            <div class="option" onclick="this.classList.toggle('selected')">A. æ§åˆ¶è¾“å‡ºé€Ÿåº¦</div>
                            <div class="option correct-option onclick="this.classList.toggle('selected')">B. æ§åˆ¶éšæœºæ€§</div>
                            <div class="option" onclick="this.classList.toggle('selected')">C. æ§åˆ¶è¾“å‡ºé•¿åº¦</div>
                            <div class="option" onclick="this.classList.toggle('selected')">D. æ§åˆ¶æ¨¡å‹é€‰æ‹©</div>
                        </div>
                    </div>

                    <div class="question">
                        <div class="question-title">
                            <span class="question-type">ç¼–ç¨‹é¢˜</span>
                            3. åˆ›å»ºä¸€ä¸ª ChatModelï¼Œå®ç°æµå¼è¾“å‡ºï¼Œå¹¶è¿½è¸ª token æˆæœ¬
                        </div>
                        <details style="margin-top: 10px;">
                            <summary style="cursor: pointer; color: var(--primary-color);">æŸ¥çœ‹å‚è€ƒç­”æ¡ˆ</summary>
                            <div class="code-block" style="margin-top: 10px;">
                                <div class="code-header">
                                    <span class="code-language">python</span>
                                    <button class="copy-btn">å¤åˆ¶</button>
                                </div>
                                <pre><code class="language-python">from langchain_openai import ChatOpenAI
from langchain.callbacks import get_openai_callback

chat = ChatOpenAI(model="gpt-4o", temperature=0.7)

with get_openai_callback() as cb:
    print("AI å›ç­”:")
    for chunk in chat.stream("ç”¨ä¸‰å¥è¯ä»‹ç» Python"):
        print(chunk.content, end="", flush=True)

    print(f"\n\næˆæœ¬ç»Ÿè®¡:")
    print(f"æ€» tokens: {cb.total_tokens}")
    print(f"æ€»æˆæœ¬: ${cb.total_cost:.4f}")</code></pre>
                            </div>
                        </details>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script src="assets/js/main.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
</body>
</html>